import{j as e,r as n,R as Le}from"./react-a3d7c6c9.js";import{c as _e}from"./react-dom-6565d738.js";import{I as O,a as E,b as h,c as xe,d as A,e as L,f as F,g as z,h as oe,i as le,j as g,k as f,l as je,m as ae,n as pe,o as Re,p as ne,q as Q,r as se,s as Se,t as ee,u as Be,v as K,w as Pe,x as $e,y as Oe,z as Ae,A as Ge,B as te,C as w,D as ce,E as De,F as We,G as He,H as qe,J as Je,K as Ue}from"./@ionic-adea6ec1.js";import{u as Ve,b as Qe,d as Ke,R as _,e as Xe}from"./react-router-fa7b4203.js";import{a as v}from"./axios-4a70c6fc.js";import{S as D}from"./sweetalert-f29ae16e.js";import{L as Ye}from"./react-router-dom-83f08af9.js";import{b as Ze,G as et}from"./@leecheuk-88aac602.js";import{g as re}from"./gapi-script-6c9bcd75.js";import{F as ke,H as Ce,T as tt,B as nt,a as st,b as Ie,c as rt,d as Ee,G as it,e as ot,I as lt,f as at,g as ct,R as dt,h as ut}from"./react-icons-b1255463.js";import{e as de}from"./ionicons-324789cf.js";import{h as Fe}from"./moment-90d1a525.js";import"./moment-timezone-1e1793f6.js";import{A as mt}from"./apexcharts-da244db7.js";import{e as ht}from"./emailjs-com-6151e9d3.js";import{C as xt}from"./react-easy-crop-a3664b00.js";/* empty css                         */import"./scheduler-765c72db.js";import"./@stencil-823be283.js";import"./tslib-6635c9de.js";import"./history-3e481430.js";import"./@babel-47f85c78.js";import"./resolve-pathname-e210f2ac.js";import"./value-equal-17d7769a.js";import"./tiny-invariant-dd7d57d2.js";import"./prop-types-8283aca8.js";import"./path-to-regexp-d17143fd.js";import"./hoist-non-react-statics-02e0905b.js";import"./normalize-wheel-6bb5511a.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const d of r)if(d.type==="childList")for(const l of d.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const d={};return r.integrity&&(d.integrity=r.integrity),r.referrerPolicy&&(d.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?d.credentials="include":r.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function s(r){if(r.ep)return;r.ep=!0;const d=o(r);fetch(r.href,d)}})();const jt=()=>{const t=Ve(),a=()=>{t.push("/nouvelle-famille")},o=()=>{t.push("/login")};return e.jsx("div",{id:"container",children:e.jsx(O,{children:e.jsxs(E,{children:[e.jsx(h,{size:"12",children:e.jsx(xe,{src:"assets/icon/SGN_07_19_2023_1689763150131.png"})}),e.jsx(h,{size:"6",children:e.jsx(A,{fill:"outline",onClick:a,id:"banner-button",children:"Nouvelle Famille"})}),e.jsx(h,{size:"6",children:e.jsx(A,{onClick:o,id:"banner-button",children:"Se connecter"})})]})})})},pt=()=>e.jsx(L,{style:{padding:"15px"},children:e.jsx(F,{fullscreen:!0,children:e.jsx(jt,{})})});const ft="https://gestion-depense-production.up.railway.app/",b=t=>ft+t,gt=(t,a)=>{var s;const o={nom:t,responsable:a};return v.post(b("familles"),o,{headers:{"X-CSRF-TOKEN":(s=document.head.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content")}})},vt=t=>v.get(b("caisse/"+t)),bt=t=>v.get(b("famille/"+t)),yt=()=>{const[t,a]=n.useState(""),[o,s]=n.useState(""),r=d=>{d.preventDefault(),gt(t,o).then(l=>{const i=l.data.famille;console.log("Famille créée avec succès",i),localStorage.setItem("famille",JSON.stringify(i)),D("Succès","La famille a été créée avec succès.","success").then(()=>{console.log(i.id),window.location.href="/nouveau-membre/:"+i.id})}).catch(l=>{console.error("Erreur lors de la création de la famille",l),D("Erreur","Erreur lors de la création de la famille.","error")})};return e.jsx("div",{id:"container",children:e.jsx("div",{id:"form",children:e.jsxs("form",{onSubmit:r,children:[e.jsx("input",{type:"hidden",name:"_token",value:"{{ csrf_token() }}"}),e.jsx("meta",{name:"csrf-token",content:"{{ csrf_token() }}"}),e.jsxs(E,{className:"ion-align-items-center",children:[e.jsx(h,{size:"12",children:e.jsx("h1",{children:"Nouvelle famille"})}),e.jsx(h,{size:"12",style:{marginTop:"15px"},children:e.jsx(z,{label:"Nom",id:"auth-form",labelPlacement:"floating",placeholder:"Entrer le nom de famille",className:"centered-text",name:"nom",style:{textAlign:"left"},fill:"outline",value:t,onIonChange:d=>a(d.detail.value)})}),e.jsx(h,{size:"12",style:{marginTop:"15px"},children:e.jsx(z,{label:"Responsable",id:"auth-form",labelPlacement:"floating",placeholder:"Entrer l'email du responsable",className:"centered-text",name:"responsable",fill:"outline",style:{textAlign:"left"},type:"email",value:o,onIonChange:d=>s(d.detail.value)})}),e.jsx(h,{size:"12",style:{marginTop:"15px"},children:e.jsx(A,{type:"submit",id:"custom-button",children:"Enregistrer"})})]})]})})})},St=()=>e.jsx(L,{children:e.jsx(F,{fullscreen:!0,children:e.jsx(yt,{})})});const Ct=()=>v.get(b("roles")),It=({onChange:t})=>{const[a,o]=n.useState([]);return n.useEffect(()=>{Ct().then(s=>{const r=Array.isArray(s.data)?s.data:s.data.roles;o(r)}).catch(s=>{console.error("Erreur lors de la récupération des rôles",s)})},[]),e.jsx(oe,{label:"Rôle",labelPlacement:"floating","aria-label":"Rôle",name:"role",placeholder:"Votre rôle",onIonChange:s=>t(s.detail.value),children:a.map(s=>e.jsx(le,{value:s.id,children:s.nom},s.id))})},Et=()=>v.get(b("sexes")),Ft=({onChange:t})=>{const[a,o]=n.useState([]);return n.useEffect(()=>{Et().then(s=>{const r=Array.isArray(s.data)?s.data:s.data.sexes;o(r)}).catch(s=>{console.error("Erreur lors de la récupération des sexes",s)})},[]),e.jsx(oe,{label:"Sexe",labelPlacement:"floating","aria-label":"Sexe",name:"sexe",placeholder:"Votre sexe",onIonChange:s=>t(s.detail.value),children:a.map(s=>e.jsx(le,{value:s.id,children:s.nom},s.id))})},At=(t,a,o,s,r,d,l,i,u)=>{const c={famille:t,nom:a,prenom:o,role:s,date_naissance:r,sexe:d,login:l,mdp:i,confirmation_mdp:u};return v.post(b("membres"),c)},M=t=>v.get(b("membre/"+t)),Dt=t=>v.get(b("membres/"+t)),kt=(t,a)=>v.get(b("profil/"+t+"/"+a)),zt=({familleId:t})=>{const s=t.split(":").join(""),[r,d]=n.useState();n.useEffect(()=>{bt(parseInt(s)).then(p=>{d(p.data.famille),console.log(r)}).catch(p=>{console.error("Erreur lors de la récupération de la famille",p)})},[]);const[l,i]=n.useState(""),[u,c]=n.useState(""),[j,R]=n.useState(""),k=p=>{R(p)},[B,T]=n.useState(""),x=p=>{const C=p.detail.value;T(C)},[m,y]=n.useState(""),q=p=>{y(p)},[P,$]=n.useState(""),[G,ge]=n.useState(""),[X,ue]=n.useState(""),U="511930498918-66soc3c8soqeoi9io0nffpjtj7rvqi1v.apps.googleusercontent.com",me=p=>{console.log("LOGIN SUCCESS! Current user: ",p.profileObj);const C=p==null?void 0:p.profileObj;i((C==null?void 0:C.familyName)||""),c((C==null?void 0:C.givenName)||""),$((C==null?void 0:C.email)||"")};n.useEffect(()=>{function p(){re.client.init({clientId:U,scope:""})}re.load("client:auth2",p)});const Y=p=>{console.log("LOGIN FAILED! res: ",p)},he=p=>{p.preventDefault(),console.log(t),At(r==null?void 0:r.id,l,u,parseInt(j),B,parseInt(m),P,G,X).then(C=>{console.log("Membre ajouté avec succès",C.data),D("Succès","Nouveau membre ajouté.","success").then(()=>{window.location.href="/login"})}).catch(C=>{console.error("Erreur lors de l'ajout du nouveau membre",C),C.response&&C.response.data&&C.response.data.message?D("Erreur",C.response.data.message,"error"):D("Erreur","Erreur lors de l'ajout du nouveau membre.","error")})};return e.jsx(F,{fullscreen:!0,children:e.jsxs("form",{onSubmit:he,id:"container-membre",children:[e.jsxs(E,{children:[e.jsx(h,{size:"12",children:e.jsxs("div",{id:"title",children:[e.jsx("h1",{children:"Nouveau membre"}),e.jsxs("h4",{children:["Famille ",r==null?void 0:r.nom]})]})}),e.jsx(h,{size:"6",children:e.jsx(g,{id:"membre-form",lines:"none",children:e.jsx(z,{label:"Nom",labelPlacement:"floating",placeholder:"Entrer votre nom",name:"nom",value:l,onIonChange:p=>i(p.detail.value)})})}),e.jsx(h,{size:"6",children:e.jsx(g,{id:"membre-form",lines:"none",children:e.jsx(z,{label:"Prénom",labelPlacement:"floating",placeholder:"Entrer votre prénom",name:"prenom",value:u,onIonChange:p=>c(p.detail.value)})})}),e.jsx(h,{size:"12",children:e.jsxs(g,{id:"membre-form",lines:"none",children:[e.jsx(f,{children:"Date de naissance"}),e.jsx(je,{datetime:"datetime"}),e.jsx(ae,{keepContentsMounted:!0,children:e.jsx(pe,{id:"datetime",presentation:"date",name:"date_naissance",onIonChange:x})})]})}),e.jsx(h,{size:"6",children:e.jsx(g,{id:"membre-form",lines:"none",children:e.jsx(Ft,{onChange:q})})}),e.jsx(h,{size:"6",children:e.jsx(g,{id:"membre-form",lines:"none",children:e.jsx(It,{onChange:k})})}),e.jsx(h,{size:"12",children:e.jsx(g,{id:"membre-form",lines:"none",children:e.jsx(z,{label:"Email",labelPlacement:"floating",placeholder:"Entrer votre email",name:"login",type:"email",value:P,onIonChange:p=>$(p.detail.value)})})}),e.jsx(h,{size:"12",children:e.jsx(g,{id:"membre-form",lines:"none",children:e.jsx(z,{label:"Mot de passe",labelPlacement:"floating",placeholder:"********",name:"mdp",type:"password",value:G,onIonChange:p=>ge(p.detail.value)})})}),e.jsx(h,{size:"12",children:e.jsx(g,{id:"membre-form",lines:"none",children:e.jsx(z,{label:"Confirmer votre mot de passe",labelPlacement:"floating",placeholder:"********",name:"confirmation",type:"password",value:X,onIonChange:p=>ue(p.detail.value)})})})]}),e.jsxs(E,{children:[e.jsxs(h,{size:"12",style:{marginTop:"25px"},children:[e.jsx(A,{id:"custom-button",type:"submit",children:"Valider"}),e.jsx(Ze.GoogleLogin,{clientId:U,render:p=>e.jsxs("button",{onClick:p.onClick,disabled:p.disabled,style:{backgroundColor:"white",marginTop:"10px",width:"100%",color:"black",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",padding:"10px 20px",borderRadius:"15px",height:"50px",fontSize:"14px",boxShadow:"rgba(149, 157, 165, 0.2) 0px 4px 24px"},children:[e.jsx(ke,{size:17}),"  S'inscrire avec Google"]}),onSuccess:me,onFailure:Y,cookiePolicy:"single_host_origin"})]}),e.jsx(h,{size:"12",style:{marginTop:"15px"},id:"link",children:e.jsx(Ye,{style:{textDecoration:"none"},to:"/login",children:"Se connecter à un compte existant"})})]})]})})},Mt=()=>{const{familleId:t}=Qe();return e.jsx(L,{style:{padding:"15px"},children:e.jsx(F,{fullscreen:!0,children:e.jsx(zt,{familleId:t})})})};const Tt=(t,a)=>{const o={login:t,mdp:a};return v.post(b("login"),o)},Nt=()=>{const[t,a]=n.useState(""),[o,s]=n.useState(""),r="511930498918-66soc3c8soqeoi9io0nffpjtj7rvqi1v.apps.googleusercontent.com",d=u=>{console.log("LOGIN SUCCESS! Current user: ",u.profileObj);const c=u==null?void 0:u.profileObj;a((c==null?void 0:c.email)||"")};n.useEffect(()=>{function u(){re.client.init({clientId:r,scope:""})}re.load("client:auth2",u)});const l=u=>{console.log("LOGIN FAILED! res: ",u)},i=async u=>{u.preventDefault(),Tt(t,o).then(c=>{console.log("Connexion réussie",c.data),sessionStorage.setItem("token",c.data.token),localStorage.removeItem("famille"),D("Succès","Connexion réussie.","success").then(()=>{window.location.href="/accueil"})}).catch(c=>{console.error("Connexion échouée",c),c.response&&c.response.data&&c.response.data.message?D("Erreur",c.response.data.message,"error"):D("Erreur","Connexion échouée.","error")})};return e.jsx("div",{id:"container",children:e.jsx("div",{id:"form",children:e.jsx("form",{onSubmit:i,children:e.jsxs(E,{children:[e.jsx(h,{size:"12",children:e.jsx("div",{id:"title",children:e.jsx("h1",{children:"Connectez-vous"})})}),e.jsx(h,{size:"12",style:{marginTop:"15px"},children:e.jsx(g,{lines:"none",id:"input-form",children:e.jsx(z,{id:"auth-form",label:"Email",style:{textAlign:"left"},labelPlacement:"floating",placeholder:"Entrer votre email",name:"login",type:"email",value:t,onIonChange:u=>a(u.detail.value)})})}),e.jsx(h,{size:"12",style:{marginTop:"15px"},children:e.jsx(g,{lines:"none",id:"input-form",children:e.jsx(z,{id:"auth-form",label:"Mot de passe",labelPlacement:"floating",style:{textAlign:"left"},placeholder:"********",name:"mdp",type:"password",value:o,onIonChange:u=>s(u.detail.value)})})}),e.jsxs(h,{size:"12",style:{marginTop:"15px"},children:[e.jsx(A,{type:"submit",id:"custom-button",children:"Se connecter"}),e.jsx(et,{clientId:r,render:u=>e.jsxs("button",{onClick:u.onClick,disabled:u.disabled,style:{backgroundColor:"white",marginTop:"10px",width:"100%",color:"black",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",padding:"10px 20px",borderRadius:"15px",height:"50px",fontSize:"14px",boxShadow:"rgba(149, 157, 165, 0.2) 0px 4px 24px"},children:[e.jsx(ke,{size:17}),"  Se connecter avec Google"]}),onSuccess:d,onFailure:l,cookiePolicy:"single_host_origin"})]})]})})})})},wt=()=>e.jsx(L,{children:e.jsx(F,{fullscreen:!0,children:e.jsx(Nt,{})})});function H(t){const{render:a,title:o}=t,[s,r]=n.useState(""),d=Ke(),l=()=>{sessionStorage.removeItem("token"),console.log("Déconnexion réussie"),window.location.replace("/login")};return n.useEffect(()=>{const i=d.pathname;i==="/accueil"?r("accueil"):i==="/revenu"?r("revenu"):i==="/depense"&&r("depense")},[d]),e.jsxs(e.Fragment,{children:[e.jsxs(Re,{contentId:"main-content",id:"menu",children:[e.jsx(ne,{className:"ion-no-border",children:e.jsx(Q,{id:"menu-toolbar",children:e.jsx(se,{children:e.jsxs(f,{style:{fontWeight:"bold"},children:["Home",e.jsx("span",{style:{color:"#A691F2"},children:"Finance"})]})})})}),e.jsx(F,{className:"ion-padding",children:e.jsxs(Se,{id:"menu-ion-list",children:[e.jsx(ee,{id:"menu-toggle",children:e.jsxs(g,{routerLink:"/accueil",lines:"none",id:"menu-item",className:s==="accueil"?"active-item":"",onClick:()=>r("accueil"),children:[e.jsx(Ce,{size:"22px"}),"  ",e.jsx(f,{children:"Accueil"})]})}),e.jsx(ee,{id:"menu-toggle",children:e.jsxs(g,{routerLink:"/budget",lines:"none",id:"menu-item",className:s==="budget"?"active-item":"",onClick:()=>r("budget"),children:[e.jsx(tt,{size:"22px"}),"  ",e.jsx(f,{children:"Budget"})]})}),e.jsx(ee,{id:"menu-toggle",children:e.jsxs(g,{routerLink:"/transaction",lines:"none",id:"menu-item",className:s==="transaction"?"active-item":"",onClick:()=>r("transaction"),children:[e.jsx(nt,{size:"22px"}),"  ",e.jsx(f,{children:"Transaction"})]})}),e.jsx(ee,{id:"menu-toggle",children:e.jsxs(g,{routerLink:"/membre",lines:"none",id:"menu-item",className:s==="membre"?"active-item":"",onClick:()=>r("membre"),children:[e.jsx(st,{size:"22px"}),"  ",e.jsx(f,{children:"Membre"})]})})]})}),e.jsxs(Be,{children:[e.jsx("hr",{}),e.jsx(Q,{id:"menu-toolbar",children:e.jsxs(g,{onClick:l,lines:"none",id:"logout-menu-item",children:[e.jsx(Ie,{size:"22px"}),"  ",e.jsx(f,{children:"Se déconnecter"})]})})]})]}),e.jsxs(L,{id:"main-content",children:[e.jsx(ne,{className:"ion-no-border",children:e.jsxs(Q,{children:[e.jsx(K,{slot:"start",children:e.jsx(Pe,{children:e.jsx(rt,{color:"#6A66F2"})})}),e.jsx(se,{style:{fontSize:"17px",fontWeight:"bold"},children:o}),e.jsx(K,{slot:"end",style:{marginRight:"20px"},children:e.jsx(A,{id:"profile",children:e.jsx(Ee,{style:{fontSize:"17px"}})})})]})}),e.jsx($e,{trigger:"profile",size:"auto",children:e.jsxs(Se,{children:[e.jsxs(g,{button:!0,lines:"none",routerLink:"/profil",children:[e.jsx(Ee,{}),"  Mon Profil"]}),e.jsxs(g,{button:!0,lines:"none",onClick:l,children:[e.jsx(Ie,{}),"  Déconnexion"]})]})}),e.jsx(F,{className:"ion-padding",children:e.jsxs(Oe,{children:[e.jsx(Ae,{children:a()}),e.jsxs(Ge,{slot:"bottom",children:[e.jsxs(te,{tab:"accueil",href:"/accueil",children:[e.jsx(Ce,{size:"22px"}),e.jsx(f,{style:{fontFamily:"QuickSand"},children:"Accueil"})]}),e.jsxs(te,{tab:"depense",href:"/depense",children:[e.jsx(it,{size:"22px"}),e.jsx(f,{style:{fontFamily:"QuickSand"},children:"Dépense"})]}),e.jsxs(te,{tab:"revenu",href:"/revenu",children:[e.jsx(ot,{size:"22px"}),e.jsx(f,{style:{fontFamily:"QuickSand"},children:"Revenu"})]}),e.jsxs(te,{tab:"stats",href:"/stats",children:[e.jsx(lt,{size:"22px"}),e.jsx(f,{style:{fontFamily:"QuickSand"},children:"Stats"})]})]})]})})]})]})}const ze=t=>v.get(b("transactions/"+t)),Lt=(t,a)=>v.get(b("transactions/"+t+"/"+a));function ie(t){return t>=1e6?(t/1e6).toFixed(0)+"M":t>=1e3?(t/1e3).toFixed(0)+"k":(t/1).toFixed(0)}function J(t){return new Intl.NumberFormat("fr-FR").format(t)}function fe(t){return Fe.locale("fr"),Fe.tz(t,"Indian/Antananarivo").fromNow()}const _t=()=>{const[t,a]=n.useState(0),[o,s]=n.useState([]),[r,d]=n.useState(!1);let l=0;return n.useEffect(()=>{const i=sessionStorage.getItem("token");M(i).then(u=>{a(u.data.membre.famille_id),d(!0)}).catch(u=>{console.error("Erreur lors de la récupération du membre",u)})},[]),n.useEffect(()=>{r&&ze(t).then(i=>{const u=Array.isArray(i.data)?i.data:i.data.transactions;s(u)}).catch(i=>{console.error("Erreur lors de la récupération des transactions",i)})},[t,r]),r?e.jsx(e.Fragment,{children:e.jsxs("div",{id:"container-transaction",children:[e.jsx("div",{id:"container-title",children:e.jsx("h3",{style:{fontSize:"15px",fontWeight:"bold"},children:"Dernières transactions"})}),o.slice(0,5).map(i=>e.jsxs("div",{id:"transaction-item",children:[e.jsxs("div",{id:"left",children:[e.jsx("div",{id:"icon",children:e.jsx(ce,{id:"icon",icon:de,style:{color:i.type_transaction==="Dépense"?"#F20587":"#07F2B0"}})}),e.jsxs("div",{id:"left-item",children:[e.jsx("div",{id:"membre",children:e.jsx(f,{style:{fontSize:"16px",fontWeight:"bold"},children:i.prenom})}),e.jsx("div",{id:"type-transaction",children:e.jsx(f,{style:{fontSize:"12px"},children:i.type})})]})]}),e.jsxs("div",{id:"right",children:[e.jsx("div",{id:"montant",children:e.jsxs(f,{style:{fontWeight:"bold"},children:["Ar ",J(i.montant)]})}),e.jsx("div",{id:"date",children:e.jsx(f,{style:{fontSize:"12px"},children:fe(i.date_transaction)})})]})]},l++)),e.jsx("div",{id:"voir-plus",children:e.jsx(A,{id:"voir-button",routerLink:"/transaction",children:"Voir plus"})})]})}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})};const Rt=t=>v.get(b("total-depense-du-mois/"+t)),Bt=t=>v.get(b("total-depense-par-mois/"+t)),Pt=()=>v.get(b("typedepenses")),$t=(t,a,o,s,r,d)=>{const l={famille:t,membre:a,type:o,montant:s,date:r,libelle:d};return v.post(b("ajout-depense"),l)},Ot=t=>v.get(b("total-depense-annuel-par-categorie/"+t)),Gt=()=>{const[t,a]=n.useState(0),[o,s]=n.useState(0),[r,d]=n.useState(!1);return n.useEffect(()=>{const l=sessionStorage.getItem("token");M(l).then(i=>{a(i.data.membre.famille_id),d(!0)}).catch(i=>{console.error("Erreur lors de la récupération du membre",i)})},[]),n.useEffect(()=>{r&&Rt(t).then(l=>{console.log(l.data),s(parseFloat(l.data.depense[0].total_depense))}).catch(l=>{console.error("Erreur lors de la récupération de la total de dépense du mois",l)})},[t,r]),r?e.jsx("div",{id:"card-depense",children:e.jsxs("div",{id:"content-depense",children:[e.jsx(at,{id:"icon-depense"}),e.jsxs("h4",{children:["Ar ",o.toLocaleString()]})]})}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})};const Wt=t=>v.get(b("total-revenu-du-mois/"+t)),Ht=t=>v.get(b("total-revenu-par-mois/"+t)),qt=()=>v.get(b("typerevenus")),Jt=(t,a,o,s,r,d)=>{const l={famille:t,membre:a,type:o,montant:s,date:r,libelle:d};return v.post(b("ajout-revenu"),l)},Ut=()=>{const[t,a]=n.useState(0),[o,s]=n.useState(0),[r,d]=n.useState(!1);return n.useEffect(()=>{const l=sessionStorage.getItem("token");M(l).then(i=>{a(i.data.membre.famille_id),d(!0)}).catch(i=>{console.error("Erreur lors de la récupération du membre",i)})},[]),n.useEffect(()=>{r&&Wt(t).then(l=>{console.log(l.data),s(parseFloat(l.data.revenu[0].total_revenu))}).catch(l=>{console.error("Erreur lors de la récupération du total de revenu du mois",l)})},[t,r]),r?e.jsx("div",{id:"card-revenu",children:e.jsxs("div",{id:"content-revenu",children:[e.jsx(ct,{id:"icon-revenu"}),e.jsxs("h4",{children:["Ar ",o.toLocaleString()]})]})}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})};const Vt=()=>{const[t,a]=n.useState(0),[o,s]=n.useState(0),[r,d]=n.useState(!1);return n.useEffect(()=>{const l=sessionStorage.getItem("token");M(l).then(i=>{a(i.data.membre.famille_id),d(!0)}).catch(i=>{console.error("Erreur lors de la récupération du membre",i)})},[]),n.useEffect(()=>{r&&vt(t).then(l=>{s(l.data.caisse[0].montant_caisse_total)}).catch(l=>{console.error("Erreur lors de la récupération de la caisse",l)})},[t,r]),r?e.jsx("div",{id:"card-caisse",children:e.jsxs("div",{id:"content-caisse",children:[e.jsx("h3",{children:"Caisse"}),e.jsxs("h4",{children:["Ar ",J(o)]})]})}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})},Qt=()=>e.jsx(e.Fragment,{children:e.jsx(O,{children:e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsxs("div",{id:"card-hero",children:[e.jsxs("div",{id:"top",children:[e.jsx("div",{id:"icon",children:e.jsx(dt,{size:"55px"})}),e.jsxs("div",{id:"right-hero",children:[e.jsx("h3",{children:"Ce mois"}),e.jsxs("div",{id:"depense-revenu",children:[e.jsx("div",{id:"depense",children:e.jsx(Gt,{})}),e.jsx("div",{id:"revenu",children:e.jsx(Ut,{})})]})]})]}),e.jsx("div",{id:"caisse",children:e.jsx(Vt,{})})]})})})})});const Kt=()=>{const[t,a]=n.useState(),[o,s]=n.useState(!1);return n.useEffect(()=>{const r=sessionStorage.getItem("token");M(r).then(d=>{a(d.data.membre),s(!0)}).catch(d=>{console.error("Erreur lors de la récupération du membre",d)})},[]),o?e.jsx("div",{id:"card-hello",children:e.jsxs("div",{id:"content-hello",children:[e.jsx("h3",{children:"Hello !"}),e.jsxs("h4",{children:[t==null?void 0:t.prenom," ",t==null?void 0:t.nom]})]})}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})},Xt=()=>e.jsxs(e.Fragment,{children:[e.jsx(O,{style:{paddingLeft:"22px"},children:e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsx(Kt,{})})})}),e.jsx(O,{children:e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsx(Qt,{})})})}),e.jsx(O,{style:{padding:"14px"},children:e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsx(_t,{})})})})]}),Yt=()=>e.jsx(H,{render:()=>e.jsx(e.Fragment,{children:e.jsx(L,{children:e.jsx(F,{fullscreen:!0,children:e.jsx(Xt,{})})})}),title:"Accueil"});const Me=({onChange:t})=>{const[a,o]=n.useState([]);return n.useEffect(()=>{Pt().then(s=>{const r=Array.isArray(s.data)?s.data:s.data.typedepenses;o(r)}).catch(s=>{console.error("Erreur lors de la récupération des types de dépense",s)})},[]),e.jsx(oe,{label:"Type de dépense",labelPlacement:"floating","aria-label":"Type de dépense",name:"typedepense",placeholder:"Choisissez le type de dépense",onIonChange:s=>t(s.detail.value),children:a.map(s=>e.jsx(le,{value:s.id,children:s.nom},s.id))})},Zt=()=>{const[t,a]=n.useState(0),[o,s]=n.useState(null),[r,d]=n.useState(""),[l,i]=n.useState(""),u=x=>{i(x)},[c,j]=n.useState(""),R=x=>{const m=x.detail.value;j(m)},[k,B]=n.useState("");n.useEffect(()=>{const x=sessionStorage.getItem("token");M(x).then(m=>{a(m.data.membre.famille_id),s(m.data.membre),console.log("fefe"+o)}).catch(m=>{console.error("Erreur lors de la récupération du membre",m)})},[]);const T=x=>{x.preventDefault(),D({title:"Attention",text:"Êtes-vous sûr de vouloir ajouter cette dépense ?",icon:"warning",buttons:["Annuler","Confirmer"]}).then(m=>{m?$t(t,o==null?void 0:o.id,parseInt(l),parseFloat(r),c,k).then(y=>{console.log("Nouvelle dépense ajoutée",y.data),D("Succès","Requête confirmée.","success").then(()=>{window.location.href="/accueil"})}).catch(y=>{console.error("Une erreur s'est produite",y)}):D("Info","Enregistrement annulé","info")})};return e.jsx(F,{fullscreen:!0,children:e.jsxs("form",{onSubmit:T,id:"form-container",children:[e.jsxs(E,{children:[e.jsx(h,{size:"12",children:e.jsx("div",{id:"title",children:e.jsx("h1",{children:"Nouvelle dépense"})})}),e.jsx(h,{size:"12",children:e.jsx(g,{lines:"none",id:"input-form",children:e.jsx(Me,{onChange:u})})}),e.jsx(h,{size:"12",children:e.jsx(g,{lines:"none",id:"input-form",children:e.jsx(z,{label:"Montant",labelPlacement:"floating",placeholder:"Entrer le montant",name:"montant",value:r,onIonChange:x=>d(x.detail.value)})})}),e.jsx(h,{size:"12",children:e.jsxs(g,{lines:"none",id:"input-form",children:[e.jsx(f,{children:"Date de dépense"}),e.jsx(je,{datetime:"datetime"}),e.jsx(ae,{keepContentsMounted:!0,children:e.jsx(pe,{id:"datetime",name:"date",onIonChange:R})})]})}),e.jsx(h,{size:"12",children:e.jsx(g,{id:"input-form",lines:"none",children:e.jsx(z,{label:"Libellé",labelPlacement:"floating",value:k,onIonChange:x=>B(x.detail.value),placeholder:"Ajouter un libellé",maxlength:20})})})]}),e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsx(A,{id:"valid-button",type:"submit",children:"Enregistrer"})})})]})})},en=()=>e.jsx(H,{render:()=>e.jsx(L,{children:e.jsx(F,{fullscreen:!0,children:e.jsx(Zt,{})})}),title:"Dépense"});const tn=({onChange:t})=>{const[a,o]=n.useState([]);return n.useEffect(()=>{qt().then(s=>{const r=Array.isArray(s.data)?s.data:s.data.typerevenus;o(r)}).catch(s=>{console.error("Erreur lors de la récupération des types de revenu",s)})},[]),e.jsx(oe,{label:"Type de revenu",labelPlacement:"floating","aria-label":"Type de revenu",name:"typerevenu",placeholder:"Choisissez le type de revenu",onIonChange:s=>t(s.detail.value),children:a.map(s=>e.jsx(le,{value:s.id,children:s.nom},s.id))})},nn=()=>{const[t,a]=n.useState(0),[o,s]=n.useState(null),[r,d]=n.useState(""),[l,i]=n.useState(""),u=x=>{i(x)},[c,j]=n.useState(""),R=x=>{const m=x.detail.value;j(m),console.log("fefe"+c)},[k,B]=n.useState("");n.useEffect(()=>{const x=sessionStorage.getItem("token");M(x).then(m=>{a(m.data.membre.famille_id),s(m.data.membre)}).catch(m=>{console.error("Erreur lors de la récupération du membre",m)})},[]);const T=x=>{x.preventDefault(),Jt(t,o==null?void 0:o.id,parseInt(l),parseFloat(r),c,k).then(m=>{console.log("Nouveau revenu ajouté",m.data),D("Succès","Nouveau revenu ajouté.","success").then(()=>{window.location.href="/accueil"})}).catch(m=>{console.error("Erreur lors de l'ajout d'un nouveau revenu",m),m.response&&m.response.data&&m.response.data.message?D("Erreur",m.response.data.message,"error"):D("Erreur","Erreur lors de l'ajout d'un nouveau revenu.","error")})};return e.jsx(F,{fullscreen:!0,children:e.jsxs("form",{onSubmit:T,id:"form-container",children:[e.jsxs(E,{children:[e.jsx(h,{size:"12",children:e.jsx("div",{id:"title",children:e.jsx("h1",{children:"Nouveau revenu"})})}),e.jsx(h,{size:"12",children:e.jsx(g,{id:"input-form",lines:"none",children:e.jsx(tn,{onChange:u})})}),e.jsx(h,{size:"12",children:e.jsx(g,{id:"input-form",lines:"none",children:e.jsx(z,{label:"Montant",labelPlacement:"floating",placeholder:"Entrer le montant",name:"montant",value:r,onIonChange:x=>d(x.detail.value)})})}),e.jsx(h,{size:"12",children:e.jsxs(g,{id:"input-form",lines:"none",children:[e.jsx(f,{children:"Date de revenu"}),e.jsx(je,{datetime:"datetime"}),e.jsx(ae,{keepContentsMounted:!0,children:e.jsx(pe,{id:"datetime",name:"date",onIonChange:R})})]})}),e.jsx(h,{size:"12",children:e.jsx(g,{id:"input-form",lines:"none",children:e.jsx(z,{label:"Libellé",labelPlacement:"floating",value:k,onIonChange:x=>B(x.detail.value),placeholder:"Ajouter un libellé",maxlength:20})})})]}),e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsx(A,{type:"submit",id:"valid-button",children:"Enregistrer"})})})]})})},sn=()=>e.jsx(H,{render:()=>e.jsx(L,{children:e.jsx(F,{fullscreen:!0,children:e.jsx(nn,{})})}),title:"Revenu"});const rn=["J","F","M","A","M","J","J","A","S","O","N","D"],on=()=>{const t=n.useRef(null),[a,o]=n.useState(0),[s,r]=n.useState(!1),d=new Date().getFullYear();return n.useEffect(()=>{const l=sessionStorage.getItem("token");M(l).then(i=>{o(i.data.membre.famille_id),r(!0)}).catch(i=>{console.error("Erreur lors de la récupération du membre",i)})},[]),n.useEffect(()=>{(async()=>{try{const i=a,[u,c]=await Promise.all([Ht(i),Bt(i)]),j=u.data.revenus,R=c.data.depenses;if(t.current){const k=j.reduce((x,m)=>{const y=m.annee;x[y]||(x[y]={labels:[],revenus:[],depenses:[]});const q=R.find(P=>P.annee===y&&P.mois===m.mois);return x[y].labels.push(rn[m.mois-1]),x[y].revenus.push(m.total_revenu/1e6),x[y].depenses.push(q?q.total_depense/1e6:0),x},{}),B=[{name:"Revenu",data:Object.values(k)[0].revenus},{name:"Dépense",data:Object.values(k)[0].depenses}],T={chart:{type:"area",toolbar:{tools:{download:!0,zoom:!0,zoomin:{color:"#9CB0D9"},zoomout:{color:"#9CB0D9"},reset:{color:"#9CB0D9"}}}},series:B,xaxis:{categories:Object.values(k)[0].labels,labels:{style:{fontFamily:"Arial"}}},dataLabels:{enabled:!1},yaxis:{labels:{formatter:x=>`${x} M`,style:{fontFamily:"QuickSand"}}},colors:["#07F2B0","#F20587"],grid:{borderColor:"#A691F2"}};new mt(t.current,T).render()}}catch(i){console.error(i)}})()},[a,s]),s?e.jsxs("div",{id:"card-dashboard",style:{fontFamily:"Quicksand"},children:[e.jsxs("h5",{style:{textAlign:"center",color:"black",fontSize:"15px"},children:["Activités ",d]}),e.jsx("div",{style:{position:"relative",height:"100%",width:"100%"},children:e.jsx("div",{ref:t})})]}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})},ln=()=>e.jsx(e.Fragment,{children:e.jsx(O,{style:{padding:"15px"},children:e.jsx(E,{children:e.jsx(h,{children:e.jsx(on,{})})})})});const an=()=>{const[t,a]=n.useState(0),[o,s]=n.useState([]),[r,d]=n.useState(0),[l,i]=n.useState(!1);let u=0;return n.useEffect(()=>{const c=sessionStorage.getItem("token");M(c).then(j=>{a(j.data.membre.famille_id),i(!0)}).catch(j=>{console.error("Erreur lors de la récupération du membre",j)})},[]),n.useEffect(()=>{l&&Ot(t).then(c=>{const j=Array.isArray(c.data)?c.data:c.data.depenses;d(c.data.somme[0].sum),s(j)}).catch(c=>{console.error("Erreur lors de la récupération des dépenses",c)})},[t,l]),l?e.jsx(e.Fragment,{children:e.jsxs("div",{id:"container-budget",children:[e.jsx("div",{id:"container-title",children:e.jsx("h3",{style:{fontSize:"15px",fontWeight:"bold"},children:"Cette année"})}),o.map(c=>e.jsx("div",{id:"depense-item",children:e.jsxs(E,{children:[e.jsx(h,{size:"1",children:e.jsx("div",{id:"icon",children:e.jsx(ce,{id:"icon",icon:de,style:{color:"#F20587",marginTop:"50%"}})})}),e.jsxs(h,{size:"11",children:[e.jsxs("div",{id:"top-depense",children:[e.jsx("div",{id:"type",children:e.jsx(f,{children:c.typedepense})}),e.jsx("div",{id:"montant-depense",children:e.jsxs(f,{children:[" ",ie(c.total_depense)]})})]}),e.jsxs("div",{id:"progress-depense",children:[e.jsx(De,{id:"progress-depense",value:c.total_depense/r}),e.jsxs(f,{children:[ie(c.total_depense/r*100),"%"]})]})]})]})},u++))]})}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})},cn=()=>e.jsx(H,{render:()=>e.jsx(e.Fragment,{children:e.jsx(L,{children:e.jsxs(F,{fullscreen:!0,children:[e.jsx(ln,{}),e.jsx(an,{})]})})}),title:"Stats"});const dn=t=>v.get(b("budget/"+t)),un=(t,a,o)=>{const s={famille:t,typedepense:a,montant:o};return v.post(b("ajout-budget"),s)};const mn=({onDismiss:t})=>{const[a,o]=n.useState(0),[s,r]=n.useState(""),d=c=>{r(c)},[l,i]=n.useState("");n.useEffect(()=>{const c=sessionStorage.getItem("token");M(c).then(j=>{o(j.data.membre.famille_id)}).catch(j=>{console.error("Erreur lors de la récupération du membre",j)})},[]);const u=c=>{c.preventDefault(),un(a,parseInt(s),parseFloat(l)).then(j=>{console.log("Nouveau budget ajouté",j.data),D("Succès","Nouveau budget ajouté.","success").then(()=>{window.location.href="/budget"})}).catch(j=>{console.error("Erreur lors de l'ajout d'un nouveau budget",j),j.response&&j.response.data&&j.response.data.message?D("Erreur",j.response.data.message,"error"):D("Erreur","Erreur lors de l'ajout d'un nouveau budget.","error")})};return e.jsxs(L,{children:[e.jsx(ne,{className:"ion-no-border",children:e.jsxs(Q,{children:[e.jsx(se,{style:{fontSize:"17px",fontWeight:"bold"},children:"Nouveau Budget"}),e.jsx(K,{slot:"end",children:e.jsx(A,{color:"medium",onClick:()=>t(null,"cancel"),children:"Annuler"})})]})}),e.jsx(F,{className:"ion-padding",children:e.jsxs("form",{onSubmit:u,id:"form-container",children:[e.jsx(g,{lines:"none",id:"input-form",children:e.jsx(Me,{onChange:d})}),e.jsx(g,{lines:"none",id:"input-form",children:e.jsx(z,{label:"Montant",labelPlacement:"floating",placeholder:"Entrer le montant",name:"montant",value:l,onIonChange:c=>i(c.detail.value)})}),e.jsx(A,{type:"submit",id:"valid-button",children:"Enregistrer"})]})})]})};function hn(){const[t,a]=We(mn,{onDismiss:(d,l)=>a(d,l)}),[o,s]=n.useState("This modal example uses the modalController to present and dismiss modals.");function r(){t({onWillDismiss:d=>{d.detail.role==="confirm"&&s(`Hello, ${d.detail.data}!`)}})}return e.jsx(A,{expand:"block",id:"button-ajouter",onClick:()=>r(),children:"+"})}const xn=()=>{const[t,a]=n.useState(0),[o,s]=n.useState([]),[r,d]=n.useState(!1);let l=0;return n.useEffect(()=>{const i=sessionStorage.getItem("token");M(i).then(u=>{a(u.data.membre.famille_id),d(!0)}).catch(u=>{console.error("Erreur lors de la récupération du membre",u)})},[]),n.useEffect(()=>{r&&dn(t).then(i=>{const u=Array.isArray(i.data)?i.data:i.data.budgets;s(u)}).catch(i=>{console.error("Erreur lors de la récupération des budgets",i)})},[t,r]),r?e.jsx(e.Fragment,{children:e.jsxs("div",{id:"container-budget",children:[e.jsxs("div",{id:"container-title",children:[e.jsx("h3",{style:{fontSize:"15px",fontWeight:"bold"},children:"Ce mois"}),e.jsx(hn,{})]}),o.map(i=>e.jsxs("div",{id:"budget-item",children:[e.jsxs("div",{id:"top-budget",children:[e.jsx("div",{id:"type",children:e.jsx(f,{children:i.typedepense})}),e.jsx("div",{id:"montant-budget",children:e.jsxs(f,{children:[" ",J(i.montant_budget)," Ar"]})})]}),e.jsx("div",{id:"progress-budget",children:e.jsx(De,{value:i.somme_depenses/i.montant_budget})}),e.jsxs("div",{id:"bottom-budget",children:[e.jsx("div",{id:"sommedepense-budget",children:e.jsxs(f,{children:["Dépense ",J(i.somme_depenses)," Ar"]})}),e.jsx("div",{id:"reste-budget",children:e.jsxs(f,{children:["Reste ",J(i.reste_budget)," Ar"]})})]})]},l++))]})}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})},jn=()=>e.jsx(H,{render:()=>e.jsx(L,{children:e.jsx(F,{fullscreen:!0,children:e.jsx(xn,{})})}),title:"Budget"});const pn=()=>{const[t,a]=n.useState(0),[o,s]=n.useState([]),[r,d]=n.useState(!1);let l=0;return n.useEffect(()=>{const i=sessionStorage.getItem("token");M(i).then(u=>{a(u.data.membre.famille_id),d(!0)}).catch(u=>{console.error("Erreur lors de la récupération du membre",u)})},[]),n.useEffect(()=>{r&&ze(t).then(i=>{const u=Array.isArray(i.data)?i.data:i.data.transactions;s(u)}).catch(i=>{console.error("Erreur lors de la récupération des transactions",i)})},[t,r]),r?e.jsx(e.Fragment,{children:e.jsxs("div",{id:"container-transaction",children:[e.jsx("div",{id:"container-title",children:e.jsx("h3",{style:{fontSize:"15px",fontWeight:"bold"},children:"Toutes les transactions"})}),o.map(i=>e.jsxs("div",{id:"transaction-item",children:[e.jsxs("div",{id:"left",children:[e.jsx("div",{id:"icon",children:e.jsx(ce,{id:"icon",icon:de,style:{color:i.type_transaction==="Dépense"?"#F20587":"#07F2B0"}})}),e.jsxs("div",{id:"left-item",children:[e.jsx("div",{id:"membre",children:e.jsx(f,{style:{fontSize:"16px",fontWeight:"bold"},children:i.prenom})}),e.jsx("div",{id:"type-transaction",children:e.jsx(f,{style:{fontSize:"12px"},children:i.type})})]})]}),e.jsxs("div",{id:"right",children:[e.jsx("div",{id:"montant",children:e.jsxs(f,{style:{fontWeight:"bold"},children:["Ar ",J(i.montant)]})}),e.jsx("div",{id:"date",children:e.jsx(f,{style:{fontSize:"12px"},children:fe(i.date_transaction)})})]})]},l++))]})}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})},fn=()=>e.jsx(H,{render:()=>e.jsx(L,{children:e.jsx(F,{fullscreen:!0,children:e.jsx(O,{style:{padding:"14px"},children:e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsx(pn,{})})})})})}),title:"Transaction"});const gn=()=>{const[t,a]=n.useState(0),[o,s]=n.useState([]),[r,d]=n.useState(!1);let l=0;const[i,u]=n.useState(!1),[c,j]=n.useState(""),[R,k]=n.useState(!1),B=()=>{u(!0)},T=()=>{u(!1)},x=()=>{if(!c){console.error("Veuillez saisir une adresse e-mail.");return}k(!0);const m="D9DohatvIaXMkHg3s",y="service_27ojfdn",q="template_nrs0typ",P={to_email:c,to_name:c,subject:"Invitation à rejoindre notre famille",message:"Bonjour, Vous êtes invité à rejoindre notre famille. Cliquez sur le lien pour vous inscrire...",famille_id:t};ht.send(y,q,P,m).then($=>{console.log("Invitation envoyée avec succès!",$),j(""),T()}).catch($=>{console.error("Erreur lors de l'envoi de l'invitation",$)}).finally(()=>{k(!1)})};return n.useEffect(()=>{const m=sessionStorage.getItem("token");M(m).then(y=>{a(y.data.membre.famille_id),d(!0)}).catch(y=>{console.error("Erreur lors de la récupération du membre",y)})},[]),n.useEffect(()=>{r&&Dt(t).then(m=>{const y=Array.isArray(m.data)?m.data:m.data.membres;s(y),console.log(o)}).catch(m=>{console.error("Erreur lors de la récupération des membres",m)})},[t,r]),r?R?e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"circular"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"container-transaction",children:[e.jsxs("div",{id:"container-title",children:[e.jsx("h3",{style:{fontSize:"15px",fontWeight:"bold"},children:"Tous les membres"}),e.jsx(A,{id:"button-ajouter",onClick:B,children:"+"})]}),o.map(m=>e.jsx("div",{id:"transaction-item",children:e.jsxs("div",{id:"left",children:[e.jsx("div",{id:"icon",children:e.jsx(xe,{src:m.photo,style:{width:"30px"}})}),e.jsxs("div",{id:"left-item",children:[e.jsx("div",{id:"membre",children:e.jsx(f,{style:{fontSize:"16px",fontWeight:"bold"},children:m.prenom})}),e.jsx("div",{id:"type-transaction",children:e.jsx(f,{style:{fontSize:"12px"},children:m.role})})]})]})},l++))]}),e.jsxs(ae,{isOpen:i,onDidDismiss:T,children:[e.jsx(ne,{className:"ion-no-border",children:e.jsxs(Q,{children:[e.jsx(se,{style:{fontSize:"17px",fontWeight:"bold"},children:"Ajouter un membre"}),e.jsx(K,{slot:"end",children:e.jsx(A,{onClick:T,color:"medium",children:"Annuler"})})]})}),e.jsx(F,{children:e.jsxs("div",{style:{marginTop:"35px",padding:"15px"},children:[e.jsx(g,{lines:"none",id:"input-form",children:e.jsx(z,{label:"Email",labelPlacement:"floating",required:!0,type:"email",placeholder:"Entrez l'adresse e-mail",value:c,onIonChange:m=>j(m.detail.value)})}),e.jsx(A,{onClick:x,id:"valid-button",children:"Envoyer l'invitation"})]})})]})]}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})},vn=()=>e.jsx(H,{render:()=>e.jsx(L,{children:e.jsx(F,{fullscreen:!0,children:e.jsx(O,{style:{padding:"14px"},children:e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsx(gn,{})})})})})}),title:"Membre"});const bn=()=>{const[t,a]=n.useState(0),[o,s]=n.useState(Object),[r,d]=n.useState(0),[l,i]=n.useState(!1),[u,c]=n.useState(!1),[j,R]=n.useState({x:0,y:0}),[k,B]=n.useState(1),[T,x]=n.useState(null),[m,y]=n.useState(""),[q,P]=n.useState(null),[$,G]=n.useState(!1),[ge,X]=n.useState(""),[ue,U]=n.useState(!1),me=()=>{c(!0),X(m),G(!0)},Y=I=>{if(c(!1),I==="gallery"){const S=document.createElement("input");S.type="file",S.accept="image/*",S.addEventListener("change",N=>{var V;const Z=(V=N.target.files)==null?void 0:V[0];if(Z){const W=new FileReader;W.onloadend=()=>{y(W.result)},W.readAsDataURL(Z)}}),S.click()}else I==="annuler"&&G(!1)},he=(I,S)=>{x(S)},p=async(I,S)=>{if(!S)return Promise.reject("Impossible de rogner l'image car l'emplacement de rognage est nul.");const N=new Image;return N.src=I,new Promise((Z,V)=>{N.onload=()=>{const W=document.createElement("canvas"),ve=N.naturalWidth/N.width,be=N.naturalHeight/N.height;W.width=S.width,W.height=S.height;const ye=W.getContext("2d");if(ye){ye.drawImage(N,S.x*ve,S.y*be,S.width*ve,S.height*be,0,0,S.width,S.height);const we=W.toDataURL("image/jpeg");Z(we)}else V("Impossible de rogner l'image")},N.onerror=()=>{V("Erreur lors du chargement de l'image")}})},C=async(I,S)=>{U(!0);try{const N=await v.post(b("modifier-photo"),{membre_id:I,image:S});console.log(N.data.message),window.location.reload()}catch(N){console.error("Erreur lors de la mise à jour de la photo de profil",N)}U(!1)};if(n.useEffect(()=>{const I=sessionStorage.getItem("token");M(I).then(S=>{d(S.data.membre.id),a(S.data.membre.famille_id),i(!0)}).catch(S=>{console.error("Erreur lors de la récupération du membre",S)})},[]),n.useEffect(()=>{l&&kt(r,t).then(I=>{console.log(I.data),s(I.data.profil)}).catch(I=>{console.error("Erreur lors de la récupération du profil du mois",I)})},[t,l]),!l)return e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})});const Te=()=>{G(!1),P(null),y("")},Ne=async()=>{if(m&&T)try{const I=await p(m,T);P(I),await C(r,I),G(!0)}catch(I){console.error("Erreur lors du rognage de l'image",I)}G(!1),P(null)};return e.jsxs("div",{id:"container-profil",children:[e.jsxs("div",{id:"profil-pic",children:[e.jsx(xe,{src:o.photo,id:"pic",alt:"profil pic"}),!$&&e.jsx(A,{id:"btn-modifier",onClick:me,children:e.jsx(f,{children:e.jsx(ut,{id:"camera-icon"})})})]}),ue&&e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})}),e.jsx(He,{isOpen:u,onDidDismiss:()=>c(!1),header:"Modifier la photo de profil",buttons:[{text:"Choisir dans la galerie",handler:()=>Y("gallery")},{text:"Annuler",handler:()=>Y("annuler"),role:"cancel"}]}),e.jsxs("div",{id:"profil-name",children:[e.jsxs("h2",{children:[o.prenom," ",o.nom]}),e.jsx("h4",{children:o.role})]}),e.jsxs("div",{id:"profil-stat",children:[e.jsxs("div",{id:"revenu-profil",children:[e.jsx("h3",{children:ie(o.total_revenu)}),e.jsx("h5",{children:"Revenu"})]}),e.jsxs("div",{id:"depense-profil",children:[e.jsx("h3",{children:ie(o.total_depense)}),e.jsx("h5",{children:"Dépense"})]})]}),$&&m&&e.jsxs("div",{id:"crop",children:[e.jsx(xt,{image:m,crop:j,zoom:k,aspect:1,onCropChange:R,onZoomChange:B,onCropComplete:he}),e.jsx("div",{className:"button-container",children:e.jsxs(K,{children:[e.jsx(A,{id:"btn-annuler",onClick:Te,children:"Annuler"}),e.jsx(A,{id:"btn-valider",onClick:Ne,children:"Valider"})]})})]})]})};const yn=()=>{const[t,a]=n.useState(0),[o,s]=n.useState(0),[r,d]=n.useState([]),[l,i]=n.useState(!1);let u=0;return n.useEffect(()=>{const c=sessionStorage.getItem("token");M(c).then(j=>{s(j.data.membre.id),a(j.data.membre.famille_id),i(!0)}).catch(j=>{console.error("Erreur lors de la récupération du membre",j)})},[]),n.useEffect(()=>{l&&Lt(t,o).then(c=>{const j=Array.isArray(c.data)?c.data:c.data.mytransactions;d(j)}).catch(c=>{console.error("Erreur lors de la récupération des transactions",c)})},[t,l]),l?e.jsx(e.Fragment,{children:e.jsxs("div",{id:"container-transaction",children:[e.jsx("div",{id:"container-title",children:e.jsx("h3",{style:{fontSize:"15px",fontWeight:"bold"},children:"Mes transactions"})}),r.map(c=>e.jsxs("div",{id:"transaction-item",children:[e.jsxs("div",{id:"left",children:[e.jsx("div",{id:"icon",children:e.jsx(ce,{id:"icon",icon:de,style:{color:c.type_transaction==="Dépense"?"#F20587":"#07F2B0"}})}),e.jsxs("div",{id:"left-item",children:[e.jsx("div",{id:"membre",children:e.jsx(f,{style:{fontSize:"16px",fontWeight:"bold"},children:c.prenom})}),e.jsx("div",{id:"type-transaction",children:e.jsx(f,{style:{fontSize:"12px"},children:c.type})})]})]}),e.jsxs("div",{id:"right",children:[e.jsx("div",{id:"montant",children:e.jsxs(f,{style:{fontWeight:"bold"},children:["Ar ",J(c.montant)]})}),e.jsx("div",{id:"date",children:e.jsx(f,{style:{fontSize:"12px"},children:fe(c.date_transaction)})})]})]},u++))]})}):e.jsx("div",{className:"spinner-container",style:{textAlign:"center"},children:e.jsx(w,{name:"dots"})})},Sn=()=>e.jsx(H,{render:()=>e.jsx(L,{children:e.jsx(F,{fullscreen:!0,children:e.jsxs(O,{style:{padding:"14px"},children:[e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsx(bn,{})})}),e.jsx(E,{children:e.jsx(h,{size:"12",children:e.jsx(yn,{})})})]})})}),title:"Profil"});qe();const Cn=()=>e.jsx(Je,{children:e.jsx(Ue,{children:e.jsxs(Ae,{children:[e.jsx(_,{exact:!0,path:"/accueil",children:e.jsx(Yt,{})}),e.jsx(_,{exact:!0,path:"/depense",children:e.jsx(en,{})}),e.jsx(_,{exact:!0,path:"/revenu",children:e.jsx(sn,{})}),e.jsx(_,{exact:!0,path:"/stats",children:e.jsx(cn,{})}),e.jsx(_,{exact:!0,path:"/budget",children:e.jsx(jn,{})}),e.jsx(_,{exact:!0,path:"/transaction",children:e.jsx(fn,{})}),e.jsx(_,{exact:!0,path:"/membre",children:e.jsx(vn,{})}),e.jsx(_,{exact:!0,path:"/profil",children:e.jsx(Sn,{})}),e.jsx(_,{exact:!0,path:"/bienvenue",children:e.jsx(pt,{})}),e.jsx(_,{exact:!0,path:"/nouvelle-famille",children:e.jsx(St,{})}),e.jsx(_,{exact:!0,path:"/nouveau-membre/:familleId",children:e.jsx(Mt,{})}),e.jsx(_,{exact:!0,path:"/login",children:e.jsx(wt,{})}),e.jsx(_,{exact:!0,path:"/",children:e.jsx(Xe,{to:sessionStorage.getItem("token")===null?"/bienvenue":"/accueil"})})]})})}),In=document.getElementById("root"),En=_e(In);En.render(e.jsx(Le.StrictMode,{children:e.jsx(Cn,{})}));
